<?xml version="1.0" encoding="UTF-8" ?>
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="file:schema.xsd" name="tecaDigitale" version="1.5">
  <fields>
    <field name="_version_" type="long" indexed="true" stored="true"/>
    <field name="_root_" type="string" indexed="true" stored="true"/>
    <field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false"/>

    <field name="_tipo_" type="string" indexed="true" stored="true" multiValued="false"/>

    <field name="tipoOggetto" type="text" indexed="true" stored="false" />
    
    <field name="provenienzaOggetto" type="text" indexed="true" stored="false" />
    
    <field name="tipoContenitore" type="text" indexed="true" stored="false" />
    
    <field name="objectIdentifier" type="text" indexed="true" stored="false" />
    
    <field name="fileType" type="text" indexed="true" stored="false" />
    
    <field name="actualFileName" type="text" indexed="true" stored="false" />
    
    <field name="compositionLevel" type="text" indexed="true" stored="false" />
    
    <field name="sha1" type="text" indexed="true" stored="false" />
    
    <field name="size" type="long" indexed="true" stored="false" />
    
    <field name="mimeType" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="promon" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="originalFileName" type="text" indexed="true" stored="false" />
    
    <field name="rights" type="text" indexed="true" stored="false"  multiValued="true"/>
    
    <field name="tarIndex" type="text" indexed="true" stored="false" />
    
    <field name="relationshipType" type="text" indexed="true" stored="false" />
    
    <field name="eventID" type="text" indexed="true" stored="false" />
    
    <field name="eventType" type="text" indexed="true" stored="false" />
    
    <field name="eventDate" type="date" indexed="true" stored="false" multiValued="true"/>
    
    <field name="eventDetail" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="eventOutCome" type="text" indexed="true" stored="false" />
    
    <field name="agentDepositante" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="agentSoftware" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="nodo" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- level  <gen level=""> -->
    <field name="tipoDocumento" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Bid dell'opera <dc:identifier> -->
    <field name="bid" type="lowercase" indexed="true" stored="false" multiValued="false"/>
    
    <!-- Numero Bni dell'opera <dc:identifier> -->
    <field name="bni" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Titolo dell'opera <dc:title> -->
    <field name="titolo" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Autore dell'opera <dc:creator> -->
    <field name="autore" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Note di pubblicazione dell'opera  <dc:publisher> -->
    <field name="pubblicazione" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Soggetto dell'opera  <dc:subject> -->
    <field name="soggetto" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Descrizione dell'opera  <dc:description> -->
    <field name="descrizione" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Contributo dell'opera  <dc:contributor> -->
    <field name="contributo" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Date dell'opera  <dc:date> -->
    <field name="data" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Tipo di risorsa dell'opera  <dc:type> -->
    <field name="tiporisorsa" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Formato dell'opera  <dc:format> -->
    <field name="formato" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Fonte dell'opera  <dc:source> -->
    <field name="fonte" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Lingua dell'opera  <dc:language> -->
    <field name="lingua" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Relazione dell'opera  <dc:relation> -->
    <field name="relazione" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Copertura dell'opera  <dc:coverage> -->
    <field name="copertura" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Gestione dei diritti dell'opera  <dc:rights> -->
    <field name="gestionediritti" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Biblioteca relativa al gestiionale dell'opera <holdings><library> -->
    <field name="biblioteca" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Inventario dell'opera <holdings><inventory_number> -->
    <field name="inventario" type="lowercase" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Collocazione dell'opera <holdings><shelfmark> -->
    <field name="collocazione" type="lowercase" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Utilizzato per gestire la sezione <piece><year> o <piece><part_number> -->
    <field name="piecegr" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Utilizzato per gestire la sezione <piece><issue> o <piece><part_name> -->
    <field name="piecedt" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Utilizzato per gestire la sezione <piece><stpiece_per> o <piece><stpiece_vol> -->
    <field name="piecein" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Set OAI 
    <field name="oaiset" type="text" indexed="true" stored="false" multiValued="true"/>
    -->
    
    <!-- Stru del mag 
    <field name="stru" type="text" indexed="true" stored="false" multiValued="false"/>
    <field name="strupos" type="string" indexed="true" stored="true" multiValued="false"/>
    -->
    
    <!-- Ocr del mag 
    <field name="ocr" type="text" indexed="true" stored="false" multiValued="false"/>
    <field name="sequenceocr" type="long" indexed="true" stored="true" multiValued="false"/>
    <field name="pagina" type="text" indexed="true" stored="false" multiValued="false"/>
    -->

    <field name="indexed" type="date" indexed="true" stored="true" default="NOW" multiValued="false"/>
    
    <field name="keywords" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <field name="keywordsDoc" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Definizione dinamica di tutti campi per la ricerca Keyword per ogni campo -->
    <dynamicField name="*_kw" type="text" indexed="true" stored="false" multiValued="true"/>
    
    <!-- Definizione dinamica di tutti campi per gli ordinamenti -->
    <dynamicField name="*_sort" type="lckey" indexed="true" stored="false" multiValued="false"/>
    
    <!-- Definizione dinamica di tutti campi per la visualizzazione dei campi -->
    <dynamicField name="*_show" type="text" indexed="false" stored="true" multiValued="true"/>

    <dynamicField name="*_fc" type="string" indexed="true" stored="false" multiValued="true"/>
  </fields>

  <uniqueKey>id</uniqueKey>

  <copyField dest="keywords" source="id"/>
  <copyField dest="keywords" source="*_kw" maxChars="8000"/>
  
  <types>

    <fieldtype name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true"/>

    <fieldtype name="long" class="solr.TrieLongField" precisionStep="0" omitNorms="true"
      positionIncrementGap="0"/>
    
    <fieldtype name="date" class="solr.TrieDateField" omitNorms="true" precisionStep="0"
      positionIncrementGap="0"/>

    <!-- lckey : text field - not tokenized, lowercase, trimmed, only alpha-numeric -->
    <fieldtype name="lckey" class="solr.TextField" sortMissingFirst="true">
      <analyzer type="index">
        <charFilter class="solr.MappingCharFilterFactory" mapping="char-mapping.txt"/>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.PatternReplaceFilterFactory" pattern="([^a-z0-9])" replacement=""
          replace="all"/>
        <filter class="solr.TrimFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <charFilter class="solr.MappingCharFilterFactory" mapping="char-mapping.txt"/>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.PatternReplaceFilterFactory" pattern="([^a-z0-9])" replacement=""
          replace="all"/>
        <filter class="solr.TrimFilterFactory"/>
      </analyzer>
    </fieldtype>

    <!-- lowercases the entire field value, keeping it as a single token.  -->
    <fieldtype name="lowercase" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldtype>

    <fieldtype name="text" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <charFilter class="solr.MappingCharFilterFactory" mapping="char-mapping.txt"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1"
          generateNumberParts="1" catenateWords="1" catenateNumbers="0" catenateAll="0"
          splitOnCaseChange="1" splitOnNumerics="0"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>
      </analyzer>
      
      <analyzer type="query">
        <charFilter class="solr.MappingCharFilterFactory" mapping="char-mapping.txt"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        
        <charFilter class="solr.MappingCharFilterFactory" mapping="char-mapping.txt"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1"
          generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0"
          splitOnCaseChange="1" splitOnNumerics="0"/>
        
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>
      </analyzer>
    </fieldtype>
  </types>

</schema>
